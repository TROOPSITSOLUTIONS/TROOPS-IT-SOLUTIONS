<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>COLOUR PICKER| TEAM BCT</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Rajdhani:wght@500;600;700;800&family=JetBrains+Mono:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* =========================================
           1. CORE VARIABLES (EXTREME RED VIBE)
           ========================================= */
        :root {
            --bg-deep: #030000;
            --app-bg: #080002;
            --card-bg: #120004;
            --card-border: #33000a;
            
            --primary: #ff0033;
            --primary-dark: #99001a;
            --primary-glow: rgba(255, 0, 51, 0.6);
            --primary-dim: rgba(255, 0, 51, 0.15);
            
            --success: #00ff41;
            --success-dim: rgba(0, 255, 65, 0.1);
            --danger: #ff2a2a;
            --danger-dim: rgba(255, 42, 42, 0.1);
            --warning: #ffcc00;
            
            --text-main: #ffffff;
            --text-mute: #ff99aa; 
            
            --font-head: 'Orbitron', sans-serif;
            --font-ui: 'Rajdhani', sans-serif;
            --font-code: 'JetBrains Mono', monospace;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: var(--font-ui);
            display: flex; justify-content: center; align-items: center;
            height: 100dvh; 
            overflow: hidden;
            background-image: radial-gradient(circle at center, #1a0005 0%, #000 100%);
        }

        /* =========================================
           2. MOBILE APP FRAME (NATIVE FEEL)
           ========================================= */
        .app-frame {
            width: 100%; max-width: 480px; height: 100%;
            background: var(--app-bg); position: relative;
            display: flex; flex-direction: column;
            box-shadow: 0 0 50px rgba(255,0,51,0.1);
            border-left: 1px solid var(--card-border);
            border-right: 1px solid var(--card-border);
            overflow: hidden;
        }

        /* RED MATRIX BG */
        #matrix-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; opacity: 0.15; pointer-events: none;
        }

        /* =========================================
           3. PERFECTED HEADER (COMPACT & HORIZONTAL)
           ========================================= */
        .app-header {
            flex-shrink: 0; padding: 15px 20px;
            background: linear-gradient(180deg, #1a0005, rgba(10,0,2,0.9));
            backdrop-filter: blur(15px);
            border-bottom: 2px solid var(--primary);
            display: flex; justify-content: space-between; align-items: center;
            z-index: 50; position: relative;
            box-shadow: 0 5px 25px rgba(255,0,51,0.3);
        }

        .header-left { display: flex; align-items: center; gap: 12px; }

        .logo-box {
            width: 40px; height: 40px;
            background: linear-gradient(135deg, var(--primary-dark), #000);
            border: 2px solid var(--primary); border-radius: 10px;
            display: flex; justify-content: center; align-items: center;
            font-size: 18px; color: #fff;
            box-shadow: inset 0 0 10px var(--primary), 0 0 15px var(--primary-glow);
            position: relative; overflow: hidden;
        }
        .logo-box::after {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg); pointer-events: none;
        }

        .brand-titles { display: flex; flex-direction: column; justify-content: center; }
        .app-title { font-family: var(--font-head); font-size: 18px; font-weight: 900; letter-spacing: 2px; color: #fff; text-shadow: 0 0 10px var(--primary-glow); line-height: 1.1; margin-bottom: 2px; }
        .app-title span { color: var(--primary); }
        .app-sub { font-family: var(--font-code); font-size: 9px; color: var(--text-mute); letter-spacing: 1px; text-transform: uppercase; }
        
        .header-right { display: flex; align-items: center; }
        .status-pill {
            background: var(--primary-dim); border: 1px solid var(--primary);
            padding: 5px 12px; border-radius: 30px; font-family: var(--font-code);
            font-size: 9px; font-weight: 800; color: #fff; letter-spacing: 1px;
            display: flex; align-items: center; gap: 6px; box-shadow: 0 0 15px var(--primary-dim);
        }
        .pulse { width: 6px; height: 6px; background: var(--primary); border-radius: 50%; animation: redPulse 1.5s infinite; }

        /* =========================================
           4. SCROLLABLE MAIN CONTENT
           ========================================= */
        .app-content {
            flex: 1; overflow-y: auto; overflow-x: hidden; 
            padding: 20px 20px 100px; /* Padding bottom for floating dock */
            position: relative; z-index: 5; scroll-behavior: smooth;
        }
        .app-content::-webkit-scrollbar { display: none; } 

        .view-section { display: none; animation: fadeIn 0.3s cubic-bezier(0.2, 0.8, 0.2, 1); }
        .view-section.active { display: block; }

        .sec-title {
            font-family: var(--font-head); font-size: 13px; color: var(--primary);
            text-transform: uppercase; letter-spacing: 1px; margin-bottom: 15px;
            display: flex; align-items: center; gap: 8px; text-shadow: 0 0 10px var(--primary-glow);
        }
        .sec-title::after { content:''; flex:1; height:1px; background: linear-gradient(90deg, var(--primary), transparent); opacity: 0.5; }

        /* =========================================
           5. VIEW 1: COLOR ENGINE 
           ========================================= */
        /* Preview Panel */
        .preview-box {
            width: 100%; height: 90px; border-radius: 12px; margin-bottom: 25px;
            border: 1px solid var(--primary); box-shadow: 0 10px 25px rgba(255,0,51,0.2);
            position: relative; overflow: hidden;
            background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAACpJREFUKFNjTc3W/88ABowgdgxL1m9A52HEqIiR1YEMwKkYlxm4FBM2CwB8GguP63Ip6AAAAABJRU5ErkJggg==');
        }
        .preview-fill {
            position: absolute; inset: 0; display: flex; flex-direction: column;
            justify-content: center; align-items: center; transition: background-color 0.1s;
        }
        .p-hex { font-family: var(--font-code); font-size: 26px; font-weight: 900; letter-spacing: 2px; text-shadow: 0 2px 8px rgba(0,0,0,0.8); }
        .p-rgb { font-family: var(--font-code); font-size: 11px; opacity: 0.9; margin-top: 5px; font-weight: bold; background: rgba(0,0,0,0.5); padding: 2px 8px; border-radius: 4px; }

        /* Color Wheel */
        .wheel-container {
            width: 250px; height: 250px; margin: 0 auto 30px; position: relative;
            border-radius: 50%; padding: 5px; background: linear-gradient(145deg, #2a0005, #000);
            box-shadow: 0 0 30px rgba(255,0,51,0.2), inset 0 0 15px #000;
            border: 1px solid var(--card-border);
        }
        #wheelCanvas { width: 100%; height: 100%; border-radius: 50%; touch-action: none; }
        .wheel-cursor {
            position: absolute; width: 26px; height: 26px; border: 3px solid #fff;
            border-radius: 50%; transform: translate(-50%, -50%); pointer-events: none;
            box-shadow: 0 0 15px rgba(0,0,0,0.9); z-index: 10; transition: background-color 0.1s;
        }

        /* Pro Sliders */
        .slider-card {
            background: var(--card-bg); border: 1px solid var(--card-border);
            padding: 15px 20px; border-radius: 12px; margin-bottom: 15px;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }
        .sl-top { display: flex; justify-content: space-between; font-size: 11px; color: var(--text-mute); font-weight: 700; margin-bottom: 12px; letter-spacing: 1px; }
        .sl-val { color: #fff; font-family: var(--font-code); font-size: 12px; }
        input[type="range"] { -webkit-appearance: none; width: 100%; height: 6px; border-radius: 3px; outline: none; background: #1a0005; border: 1px solid var(--primary-dark); }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; width: 22px; height: 22px; border-radius: 50%;
            background: #fff; cursor: pointer; border: 4px solid var(--primary); box-shadow: 0 0 15px var(--primary-glow);
        }
        #slV { background: linear-gradient(to right, #000, #ff0033, #fff); }
        #slA { background: linear-gradient(to right, transparent, var(--primary)); }

        /* Data Grid */
        .data-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 25px; }
        .data-box {
            background: var(--card-bg); border: 1px solid var(--card-border);
            padding: 15px; border-radius: 10px; position: relative; transition: 0.2s;
            border-left: 3px solid var(--primary-dark); cursor: pointer;
        }
        .data-box:active { border-color: var(--primary); background: #1a0005; transform: scale(0.98); border-left-color: var(--primary); }
        .d-lbl { font-family: var(--font-code); font-size: 9px; color: var(--text-mute); margin-bottom: 5px; letter-spacing: 1px; }
        .d-val { font-family: var(--font-code); font-size: 13px; color: #fff; font-weight: bold; }
        .btn-copy { position: absolute; top: 15px; right: 15px; color: var(--primary-dark); font-size: 14px; background: none; border: none; transition: 0.2s; }
        .data-box:active .btn-copy { color: var(--primary); text-shadow: 0 0 10px var(--primary); }

        /* Code Export */
        .code-box {
            background: #000; border: 1px dashed var(--primary-dark); border-radius: 10px;
            padding: 15px; font-family: var(--font-code); font-size: 11px; color: var(--primary);
            display: flex; justify-content: space-between; align-items: center; cursor: pointer;
        }
        .code-box:active { background: var(--primary-dim); border-color: var(--primary); }

        /* =========================================
           6. VIEW 2: TOOLS & RESPONSIVE PALETTES
           ========================================= */
        
        /* Red Scale Generator */
        .scale-wrap { display: flex; flex-direction: column; gap: 8px; margin-bottom: 25px; }
        .scale-bar { display: flex; height: 50px; border-radius: 8px; overflow: hidden; border: 1px solid var(--card-border); }
        .s-color { flex: 1; transition: flex 0.3s; display: flex; justify-content: center; align-items: center; cursor: pointer; }
        .s-color:hover, .s-color:active { flex: 2; z-index: 2; box-shadow: 0 0 20px rgba(0,0,0,0.8); }
        .s-hex { font-family: var(--font-code); font-size: 9px; color: #fff; opacity: 0; background: rgba(0,0,0,0.6); padding: 2px 4px; border-radius: 3px; transition: 0.3s; }
        .s-color:hover .s-hex, .s-color:active .s-hex { opacity: 1; }

        /* Responsive Palettes Grid */
        .pal-container { display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 25px; }
        .pal-card { background: var(--card-bg); border: 1px solid var(--card-border); padding: 15px; border-radius: 10px; }
        .pal-title { font-family: var(--font-ui); font-size: 11px; color: var(--text-mute); margin-bottom: 10px; text-transform: uppercase; font-weight: 700; }
        .pal-row { display: flex; height: 45px; border-radius: 6px; overflow: hidden; border: 1px solid #000; }
        .pal-c { flex: 1; display: flex; justify-content: center; align-items: center; transition: flex 0.3s; cursor: pointer; }
        .pal-c:active { flex: 2; }
        .pal-c .pal-hex { font-family: var(--font-code); font-size: 9px; color: #fff; opacity: 0; background: rgba(0,0,0,0.5); padding: 2px 4px; border-radius: 3px; }
        .pal-c:active .pal-hex { opacity: 1; }

        /* WCAG */
        .wcag-card {
            background: #000; border: 1px solid var(--card-border); padding: 20px;
            border-radius: 10px; text-align: center; margin-bottom: 20px;
        }
        .w-txt { font-family: var(--font-head); font-size: 22px; font-weight: 900; margin-bottom: 10px; letter-spacing: 2px; }
        .w-badge { font-family: var(--font-code); font-size: 11px; padding: 5px 15px; border-radius: 20px; font-weight: bold; display: inline-block; border: 1px solid currentColor; }

        /* =========================================
           7. VIEW 3: IMAGE SCANNER
           ========================================= */
        .upload-area {
            border: 2px dashed var(--primary-dark); background: rgba(255,0,51,0.02);
            border-radius: 16px; padding: 50px 20px; text-align: center;
            margin-top: 10px; transition: 0.3s; cursor: pointer;
        }
        .upload-area:active { background: var(--primary-dim); border-color: var(--primary); }
        .upload-area i { font-size: 50px; color: var(--primary); margin-bottom: 15px; text-shadow: var(--primary-glow); }
        .upload-area h3 { font-family: var(--font-head); font-size: 16px; color: #fff; margin-bottom: 5px; letter-spacing: 1px; }
        .upload-area p { font-size: 11px; color: var(--text-mute); }

        .scanner-stage {
            position: relative; margin-top: 20px; display: none; width: 100%;
            border-radius: 12px; overflow: hidden; border: 1px solid var(--primary-dark);
            background: #000; touch-action: none; box-shadow: 0 10px 30px rgba(255,0,51,0.1);
        }
        #targetImg { width: 100%; display: block; object-fit: contain; }
        
        .loupe {
            position: absolute; width: 90px; height: 90px; border: 3px solid var(--primary);
            border-radius: 50%; pointer-events: none; display: none;
            box-shadow: 0 5px 25px #000, 0 0 15px var(--primary-glow); 
            background: #000; z-index: 50; overflow: hidden;
        }
        .loupe-cross {
            position: absolute; top: 50%; left: 50%; width: 8px; height: 8px;
            background: transparent; border: 1px solid #fff;
            transform: translate(-50%, -50%); border-radius: 50%;
        }

        .scan-result {
            display: none; margin-top: 20px; background: var(--card-bg);
            border: 1px solid var(--primary); border-radius: 12px; padding: 15px;
            align-items: center; gap: 15px; box-shadow: 0 5px 20px var(--primary-dim);
            cursor: pointer;
        }
        .scan-result:active { background: var(--primary-dim); }
        #scanColorBox { width: 50px; height: 50px; border-radius: 10px; border: 2px solid #fff; box-shadow: 0 0 10px rgba(0,0,0,0.5); }
        .scan-data { flex: 1; }
        .scan-hex { font-family: var(--font-code); font-size: 20px; color: #fff; font-weight: bold; }
        .scan-rgb { font-family: var(--font-code); font-size: 10px; color: var(--text-mute); margin-top: 4px; }

        .btn-reset {
            width: 100%; background: var(--card-bg); border: 1px solid var(--card-border);
            color: #fff; padding: 15px; border-radius: 8px; font-family: var(--font-head);
            font-size: 12px; font-weight: bold; letter-spacing: 1px; margin-top: 20px;
            display: none; justify-content: center; align-items: center; gap: 10px; cursor: pointer;
        }
        .btn-reset:active { background: var(--primary-dim); border-color: var(--primary); color: var(--primary); }

        /* =========================================
           8. PREMIUM FLOATING BOTTOM NAVIGATION 
           ========================================= */
        .bottom-nav {
            position: absolute; bottom: 25px; left: 5%; width: 90%;
            background: rgba(10, 0, 5, 0.95); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--primary-dark); border-radius: 30px;
            padding: 10px 15px; display: flex; justify-content: space-around; align-items: center;
            z-index: 100; box-shadow: 0 10px 30px rgba(0,0,0,0.9), 0 0 15px rgba(255,0,51,0.15);
        }
        .nav-item {
            display: flex; flex-direction: column; align-items: center; gap: 4px;
            color: #666; font-family: var(--font-ui); font-size: 10px; font-weight: 700;
            padding: 8px 20px; border-radius: 20px; transition: 0.3s; cursor: pointer;
            position: relative;
        }
        .nav-item i { font-size: 18px; transition: 0.3s; }
        
        /* Premium Active Indicator */
        .nav-item.active { color: #fff; background: var(--primary-dim); }
        .nav-item.active i { color: var(--primary); text-shadow: 0 0 10px var(--primary-glow); transform: scale(1.1); }
        .nav-item.active::after {
            content: ''; position: absolute; bottom: 4px; left: 50%; transform: translateX(-50%);
            width: 4px; height: 4px; background: var(--primary); border-radius: 50%;
            box-shadow: 0 0 8px var(--primary);
        }

        /* =========================================
           9. FOOTER & TOAST
           ========================================= */
        footer {
            text-align: center; padding: 20px 15px 30px; font-family: 'Orbitron', sans-serif;
            font-size: 0.65rem; letter-spacing: 1.5px; color: #555;
            border-top: 1px dashed var(--card-border); margin-top: 15px;
        }
        footer strong { color: var(--primary); text-shadow: var(--primary-glow); }

        #toast {
            position: fixed; top: 100px; left: 50%; transform: translate(-50%, -20px);
            background: #fff; color: #000; padding: 12px 25px; border-radius: 30px;
            font-family: var(--font-code); font-size: 11px; font-weight: 900;
            opacity: 0; pointer-events: none; transition: 0.3s ease; z-index: 9999;
            box-shadow: 0 10px 30px rgba(255,255,255,0.2); display: flex; align-items: center; gap: 8px;
        }
        #toast.show { transform: translate(-50%, 0); opacity: 1; }

        @keyframes redPulse { 0% { box-shadow: 0 0 0 0 rgba(255,0,51,0.6); } 70% { box-shadow: 0 0 0 10px rgba(255,0,51,0); } 100% { box-shadow: 0 0 0 0 rgba(255,0,51,0); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <div class="app-frame">
        
        <canvas id="matrix-canvas"></canvas>

        <div class="app-header">
            <div class="header-left">
                <div class="logo-box"><i class="fas fa-palette"></i></div>
                <div class="brand-titles">
                    <div class="app-title">COLOUR <span>PICKER</span></div>
                    <div class="app-sub">VISUAL FORENSICS V4</div>
                </div>
            </div>
            <div class="header-right">
                <div class="status-pill">
                    <div class="pulse"></div> ONLINE
                </div>
            </div>
        </div>

        <div class="app-content">
            
            <div id="view-home" class="view-section active">
                
                <div class="preview-box">
                    <div class="preview-fill" id="previewBg">
                        <div class="p-hex" id="previewHex">#FF0033</div>
                        <div class="p-rgb" id="previewRgbText">rgb(255, 0, 51)</div>
                    </div>
                </div>

                <div class="wheel-container" id="wheelBox">
                    <canvas id="wheelCanvas" width="250" height="250"></canvas>
                    <div class="wheel-cursor" id="cursor"></div>
                </div>

                <div class="slider-card">
                    <div class="sl-top"><span>LUMINANCE (V)</span><span class="sl-val" id="vVal">100%</span></div>
                    <input type="range" id="slV" min="0" max="100" value="100">
                </div>
                <div class="slider-card">
                    <div class="sl-top"><span>OPACITY (A)</span><span class="sl-val" id="aVal">100%</span></div>
                    <input type="range" id="slA" min="0" max="100" value="100">
                </div>

                <div class="sec-title"><i class="fas fa-database"></i> Color Data Matrix</div>
                <div class="data-grid">
                    <div class="data-box" onclick="copyData('outHex')">
                        <i class="fas fa-copy btn-copy"></i>
                        <div class="d-lbl">HEX CODE</div><div class="d-val" id="outHex">#FF0033</div>
                    </div>
                    <div class="data-box" onclick="copyData('outRgb')">
                        <i class="fas fa-copy btn-copy"></i>
                        <div class="d-lbl">RGB VALUE</div><div class="d-val" id="outRgb">255, 0, 51</div>
                    </div>
                    <div class="data-box" onclick="copyData('outHsl')">
                        <i class="fas fa-copy btn-copy"></i>
                        <div class="d-lbl">HSL VALUE</div><div class="d-val" id="outHsl">348, 100%, 50%</div>
                    </div>
                    <div class="data-box" onclick="copyData('outCmyk')">
                        <i class="fas fa-copy btn-copy"></i>
                        <div class="d-lbl">CMYK</div><div class="d-val" id="outCmyk">0, 100, 80, 0</div>
                    </div>
                </div>

                <div class="code-box" onclick="copyData('codeCss')">
                    <span><i class="fas fa-code"></i> CSS VAR</span>
                    <span id="codeCss">--bct-main: #FF0033;</span>
                </div>

                <footer>
                    <p>© 2026 <strong>BANGLADESH CYBER TROOPS</strong> | <br>DEVELOPED BY <strong>TROOPS IT SOLUTIONS</strong></p>
                </footer>
            </div>

            <div id="view-tools" class="view-section">
                
                <div class="sec-title"><i class="fas fa-fire"></i> Red Scale Generator</div>
                <div style="font-family:var(--font-ui); font-size:11px; color:var(--text-mute); margin-bottom:10px;">Auto-generated intensity scale based on selection</div>
                <div class="scale-wrap">
                    <div class="scale-bar" id="redScaleBar">
                        </div>
                </div>

                <div class="sec-title" style="margin-top:30px;"><i class="fas fa-swatchbook"></i> Responsive Palettes</div>
                <div class="pal-container">
                    <div class="pal-card">
                        <div class="pal-title">Complementary</div>
                        <div class="pal-row" id="palComp"></div>
                    </div>
                    <div class="pal-card">
                        <div class="pal-title">Analogous</div>
                        <div class="pal-row" id="palAna"></div>
                    </div>
                    <div class="pal-card">
                        <div class="pal-title">Triadic</div>
                        <div class="pal-row" id="palTri"></div>
                    </div>
                </div>

                <div class="sec-title" style="margin-top:30px;"><i class="fas fa-eye"></i> WCAG Contrast Lab</div>
                <div class="wcag-card">
                    <div class="w-txt" id="tbText">DARK BACKGROUND</div>
                    <div class="w-badge" id="tbScore" style="background:var(--success); color:#000;">PASS (12.5)</div>
                    <p style="font-family:var(--font-code); font-size:9px; color:#555; margin-top:10px;">Simulates readability on deep black (#000)</p>
                </div>
                
                <footer>
                    <p>© 2026 <strong>BANGLADESH CYBER TROOPS</strong> | <br>DEVELOPED BY <strong>TROOPS IT SOLUTIONS</strong></p>
                </footer>
            </div>

            <div id="view-image" class="view-section">
                <div class="sec-title" style="margin-top:0;"><i class="fas fa-satellite-dish"></i> Image Pixel Extractor</div>
                
                <div class="upload-area" id="upZone" onclick="document.getElementById('fileIn').click()">
                    <i class="fas fa-fingerprint"></i>
                    <h3>TAP TO UPLOAD</h3>
                    <p>Load an image to extract exact hex codes</p>
                    <input type="file" id="fileIn" hidden accept="image/*">
                </div>

                <div class="scanner-stage" id="imgStage">
                    <img id="targetImg" src="">
                    <div class="loupe" id="loupe"><div class="loupe-cross"></div></div>
                </div>

                <div class="scan-result" id="imgResult" onclick="copyData('imgHex')">
                    <div id="scanColorBox"></div>
                    <div class="scan-data">
                        <div class="scan-hex" id="imgHex">#000000</div>
                        <div class="scan-rgb" id="imgRgb">rgb(0, 0, 0)</div>
                    </div>
                    <i class="fas fa-copy" style="color:var(--primary); font-size:20px;"></i>
                </div>

                <div class="btn-reset" id="btnResetImg" onclick="resetImage()">
                    <i class="fas fa-redo"></i> UPLOAD NEW IMAGE
                </div>
                
                <footer>
                    <p>© 2026 <strong>BANGLADESH CYBER TROOPS</strong> | <br>DEVELOPED BY <strong>TROOPS IT SOLUTIONS</strong></p>
                </footer>
            </div>

        </div> <div class="bottom-nav">
            <div class="nav-item active" onclick="switchNav('view-home', this)">
                <i class="fas fa-dharmachakra"></i>
                <span>ENGINE</span>
            </div>
            <div class="nav-item" onclick="switchNav('view-tools', this)">
                <i class="fas fa-vials"></i>
                <span>TOOLS</span>
            </div>
            <div class="nav-item" onclick="switchNav('view-image', this)">
                <i class="fas fa-crosshairs"></i>
                <span>SCANNER</span>
            </div>
        </div>

    </div> <div id="toast"><i class="fas fa-check-circle"></i> <span id="toastMsg">COPIED</span></div>
    <canvas id="pCanvas" style="display:none;"></canvas>

    <script>
        // --- 1. Matrix Background ---
        const mcvs = document.getElementById('matrix-canvas');
        const mctx = mcvs.getContext('2d');
        function initMatrix() {
            mcvs.width = mcvs.parentElement.clientWidth;
            mcvs.height = mcvs.parentElement.clientHeight;
        }
        window.addEventListener('resize', initMatrix); setTimeout(initMatrix, 100);
        const chars = "BCT01$#%".split('');
        const drops = Array(40).fill(1);
        setInterval(() => {
            mctx.fillStyle = 'rgba(3,0,0,0.15)'; mctx.fillRect(0,0,mcvs.width,mcvs.height);
            mctx.fillStyle = 'rgba(255, 0, 51, 0.4)'; mctx.font = '10px monospace';
            drops.forEach((y, i) => {
                mctx.fillText(chars[Math.floor(Math.random()*chars.length)], i*12, y*12);
                if(y*12 > mcvs.height && Math.random() > 0.95) drops[i] = 0;
                drops[i]++;
            });
        }, 50);

        // --- 2. Navigation Logic ---
        function switchNav(viewId, btn) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            document.querySelector('.app-content').scrollTo(0, 0);
        }

        // Universal Copy Function
        function copyData(id) { fallbackCopy(document.getElementById(id).innerText); }
        window.copyHex = function(hex) { fallbackCopy(hex); }

        function fallbackCopy(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed"; textArea.style.left = "-9999px";
            document.body.appendChild(textArea);
            textArea.focus(); textArea.select();
            try { document.execCommand('copy'); showToast(text); } 
            catch (err) { alert("Copy failed."); }
            document.body.removeChild(textArea);
        }

        function showToast(text) {
            const t = document.getElementById('toast');
            document.getElementById('toastMsg').innerText = `${text} COPIED`;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2000);
        }

        // --- 3. Math & Conversions ---
        function hsvToRgb(h,s,v){ s/=100; v/=100; let f=(n,k=(n+h/60)%6)=>v-v*s*Math.max(Math.min(k,4-k,1),0); return {r:Math.round(f(5)*255),g:Math.round(f(3)*255),b:Math.round(f(1)*255)}; }
        function rgbToHex(r,g,b){ return "#" + ((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1).toUpperCase(); }
        function hsvToHsl(h,s,v){ s/=100; v/=100; const l=(2-s)*v/2; if(l!=0){if(l==1)s=0; else if(l<0.5)s=s*v/(l*2); else s=s*v/(2-l*2);} return {h:Math.round(h), s:Math.round(s*100), l:Math.round(l*100)}; }
        function rgbToCmyk(r,g,b){ let c=1-(r/255), m=1-(g/255), y=1-(b/255), k=Math.min(c,Math.min(m,y)); return {c:Math.round(((c-k)/(1-k)||0)*100), m:Math.round(((m-k)/(1-k)||0)*100), y:Math.round(((y-k)/(1-k)||0)*100), k:Math.round(k*100)}; }
        function hslToHex(h,s,l){ l/=100; const a=s*Math.min(l,1-l)/100; const f=n=>{const k=(n+h/30)%12; const color=l-a*Math.max(Math.min(k-3,9-k,1),-1); return Math.round(255*color).toString(16).padStart(2,'0');}; return `#${f(0)}${f(8)}${f(4)}`.toUpperCase(); }
        
        function getLuminance(r, g, b) { let a = [r, g, b].map(v => { v /= 255; return v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4); }); return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722; }
        function getContrast(rgb1, rgb2) { let lum1 = getLuminance(rgb1.r, rgb1.g, rgb1.b); let lum2 = getLuminance(rgb2.r, rgb2.g, rgb2.b); let brightest = Math.max(lum1, lum2); let darkest = Math.min(lum1, lum2); return (brightest + 0.05) / (darkest + 0.05); }

        // --- 4. Color Wheel Engine (Mobile Perfected) ---
        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const wheelBox = document.getElementById('wheelBox');
        const cursor = document.getElementById('cursor');
        
        const W_SIZE = 250, CX = 125, CY = 125, RAD = 125;
        let h = 348, s = 100, v = 100, a = 1;

        function drawWheel() {
            ctx.clearRect(0,0,W_SIZE,W_SIZE);
            for(let i=0; i<360; i++) {
                ctx.beginPath(); ctx.moveTo(CX, CY);
                ctx.arc(CX, CY, RAD, (i-0.6)*(Math.PI/180), (i+1.6)*(Math.PI/180));
                ctx.fillStyle = `hsl(${i}, 100%, 50%)`; ctx.fill();
            }
            const g = ctx.createRadialGradient(CX, CY, 0, CX, CY, RAD);
            g.addColorStop(0, 'white'); g.addColorStop(1, 'rgba(255,255,255,0)');
            ctx.fillStyle = g; ctx.beginPath(); ctx.arc(CX, CY, RAD, 0, Math.PI*2); ctx.fill();
        }
        drawWheel();

        function updateWheel(x, y) {
            const dx = x - CX; const dy = y - CY;
            const dist = Math.sqrt(dx*dx + dy*dy);
            let ang = Math.atan2(dy, dx) * (180/Math.PI);
            if(ang < 0) ang += 360;
            let sat = (dist/RAD)*100; if(sat > 100) sat = 100;

            const fDist = Math.min(dist, RAD);
            const rAng = ang * (Math.PI/180);
            cursor.style.left = (CX + fDist * Math.cos(rAng)) + 'px';
            cursor.style.top = (CY + fDist * Math.sin(rAng)) + 'px';

            h = ang; s = sat; updateUI();
        }

        function handleInput(e) {
            const rect = canvas.getBoundingClientRect();
            let clientX = e.touches ? e.touches[0].clientX : e.clientX;
            let clientY = e.touches ? e.touches[0].clientY : e.clientY;
            let x = (clientX - rect.left) * (W_SIZE / rect.width);
            let y = (clientY - rect.top) * (W_SIZE / rect.height);
            updateWheel(x, y);
        }

        let isDrag = false;
        wheelBox.addEventListener('touchstart', e => { isDrag=true; document.body.style.overflow='hidden'; handleInput(e); }, {passive:false});
        wheelBox.addEventListener('touchmove', e => { if(isDrag) { e.preventDefault(); handleInput(e); } }, {passive:false});
        window.addEventListener('touchend', () => { isDrag=false; document.body.style.overflow='auto'; });

        wheelBox.addEventListener('mousedown', e => { isDrag=true; handleInput(e); });
        window.addEventListener('mousemove', e => { if(isDrag) handleInput(e); });
        window.addEventListener('mouseup', () => { isDrag=false; });

        document.getElementById('slV').addEventListener('input', e => { v = parseInt(e.target.value); document.getElementById('vVal').innerText=v+'%'; updateUI(); });
        document.getElementById('slA').addEventListener('input', e => { a = parseInt(e.target.value)/100; document.getElementById('aVal').innerText=Math.round(a*100)+'%'; updateUI(); });

        // --- 5. UI Sync ---
        function updateUI() {
            const rgb = hsvToRgb(h,s,v); const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
            const hsl = hsvToHsl(h,s,v); const cmyk = rgbToCmyk(rgb.r, rgb.g, rgb.b);
            const rgbaStr = `rgba(${rgb.r},${rgb.g},${rgb.b},${a})`;
            const isDark = (v > 60 && s < 40);

            // Preview
            document.getElementById('previewBg').style.backgroundColor = rgbaStr;
            document.getElementById('previewHex').innerText = hex;
            document.getElementById('previewHex').style.color = isDark ? '#000' : '#fff';
            document.getElementById('previewRgbText').innerText = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
            document.getElementById('previewRgbText').style.color = isDark ? '#33000a' : '#ff99aa';
            cursor.style.backgroundColor = hex;

            // Cards
            document.getElementById('outHex').innerText = hex;
            document.getElementById('outRgb').innerText = `${rgb.r}, ${rgb.g}, ${rgb.b}`;
            document.getElementById('outHsl').innerText = `${hsl.h}, ${hsl.s}%, ${hsl.l}%`;
            document.getElementById('outCmyk').innerText = `${cmyk.c}, ${cmyk.m}, ${cmyk.y}, ${cmyk.k}`;
            
            document.getElementById('codeCss').innerText = `--bct-main: ${hex};`;

            // WCAG Contrast
            const cBlack = getContrast(rgb, {r:0,g:0,b:0}).toFixed(2);
            document.getElementById('tbText').style.color = rgbaStr;
            document.getElementById('tbScore').innerText = cBlack >= 4.5 ? `PASS (${cBlack})` : `FAIL (${cBlack})`;
            document.getElementById('tbScore').style.background = cBlack >= 4.5 ? 'var(--success)' : 'var(--danger)';

            // Generate Scale & Palettes
            generateRedScale(hsl);
            generatePalettes(hsl);
        }

        // Red Scale Generator
        function generateRedScale(hsl) {
            const bar = document.getElementById('redScaleBar'); bar.innerHTML = '';
            const lightLevels = [80, 65, hsl.l, 35, 20];
            lightLevels.forEach(l => {
                let shex = hslToHex(hsl.h, hsl.s, l);
                bar.innerHTML += `<div class="s-color" style="background:${shex}" onclick="copyHex('${shex}')"><div class="s-hex">${shex}</div></div>`;
            });
        }

        function generatePalettes(hsl) {
            const createRow = (id, angles) => {
                const el = document.getElementById(id); el.innerHTML = '';
                angles.forEach(ang => {
                    let nh = (hsl.h + ang) % 360; if(nh<0) nh+=360;
                    let phex = hslToHex(nh, hsl.s, hsl.l);
                    el.innerHTML += `<div class="pal-c" style="background:${phex}" onclick="copyHex('${phex}')"><div class="pal-hex">${phex}</div></div>`;
                });
            };
            createRow('palComp', [0, 180]); createRow('palAna', [0, 30, -30]); createRow('palTri', [0, 120, 240]);
        }

        // --- 6. Image Scanner ---
        const fileIn = document.getElementById('fileIn');
        const img = document.getElementById('targetImg');
        const imgStage = document.getElementById('imgStage');
        const loupe = document.getElementById('loupe');
        const pCanvas = document.getElementById('pCanvas');
        const pCtx = pCanvas.getContext('2d');

        fileIn.addEventListener('change', e => {
            const f = e.target.files[0];
            if(f) {
                const r = new FileReader();
                r.onload = evt => {
                    img.src = evt.target.result;
                    imgStage.style.display = 'block';
                    document.getElementById('upZone').style.display = 'none';
                    document.getElementById('btnResetImg').style.display = 'flex';
                    img.onload = () => {
                        pCanvas.width = img.naturalWidth; pCanvas.height = img.naturalHeight;
                        pCtx.drawImage(img, 0, 0);
                    }
                };
                r.readAsDataURL(f);
            }
        });

        window.resetImage = function() {
            img.src = ''; imgStage.style.display = 'none';
            document.getElementById('imgResult').style.display = 'none';
            document.getElementById('btnResetImg').style.display = 'none';
            document.getElementById('upZone').style.display = 'block';
        }

        const pickImg = (e) => {
            if(!img.src) return;
            loupe.style.display = 'block';
            
            const r = img.getBoundingClientRect();
            let cX = e.touches ? e.touches[0].clientX : e.clientX;
            let cY = e.touches ? e.touches[0].clientY : e.clientY;

            if(cX < r.left || cX > r.right || cY < r.top || cY > r.bottom) return;

            let x = cX - r.left; let y = cY - r.top;
            
            loupe.style.left = (x - 45) + 'px'; loupe.style.top = (y - 90) + 'px'; 

            const sx = img.naturalWidth / r.width; const sy = img.naturalHeight / r.height;
            let px = Math.floor(x * sx); let py = Math.floor(y * sy);
            px = Math.max(0, Math.min(px, img.naturalWidth - 1));
            py = Math.max(0, Math.min(py, img.naturalHeight - 1));

            loupe.style.backgroundImage = `url(${img.src})`;
            loupe.style.backgroundRepeat = 'no-repeat';
            loupe.style.backgroundSize = `${r.width * 2}px ${r.height * 2}px`;
            loupe.style.backgroundPosition = `-${x * 2 - 45}px -${y * 2 - 45}px`;

            const d = pCtx.getImageData(px, py, 1, 1).data;
            const hex = rgbToHex(d[0], d[1], d[2]);

            loupe.style.borderColor = hex;
            document.getElementById('imgResult').style.display = 'flex';
            document.getElementById('scanColorBox').style.backgroundColor = hex;
            document.getElementById('imgHex').innerText = hex;
            document.getElementById('imgRgb').innerText = `rgb(${d[0]}, ${d[1]}, ${d[2]})`;
        };

        let isImgDrag = false;
        imgStage.addEventListener('touchstart', e => { isImgDrag=true; pickImg(e); }, {passive:true});
        imgStage.addEventListener('touchmove', e => { if(isImgDrag) { e.preventDefault(); pickImg(e); } }, {passive:false});
        imgStage.addEventListener('touchend', () => { isImgDrag=false; loupe.style.display='none'; });

        imgStage.addEventListener('mousemove', pickImg);
        imgStage.addEventListener('mouseleave', () => loupe.style.display='none');

        // Init App with default BCT Red
        updateWheel(CX + 80, CY);

    </script>
</body>
</html>
